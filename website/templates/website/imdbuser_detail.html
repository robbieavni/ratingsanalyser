{% extends 'website/main.html' %}
{% load bootstrap3 %}

{% block main_content %}
    <div class="row">

        <div class="col-lg-12 text-center">

            <h2>Detail page for {{ object.imdb_id }}</h2>
            <p>Number of items rated is {{ total_rated }}</p>
            <p>Number of actual films rated (excluding TV shows etc.) is {{ total_films_rated }}</p>
            <p>Average Rating is {{ average_rating }}</p>
            <p>Average IMDB rating for films rated is {{ average_imdb_rating }}</p>

            <div id="container" style="width:100%; height:400px;"></div>

        </div>

    </div>
{% endblock %}

{% block post_main_script %}
    <script>
        $(function () {
            $('#container').highcharts({
                chart: {
                    zoomType: 'xy'
                },
                title: {
                    text: 'Ratings by Decade'
                },
                xAxis: [{
                    categories: [
                                    {% for decade in decades_dictionary %}
                                        {% if decade.1.0 > 1 %}
                                            '{{ decade.0 }}',
                                        {% endif %}
                                    {% endfor %}
                    ],
                    crosshair: true
                }],
                yAxis: [{ // Primary yAxis
                    labels: {
                        format: '{value}',
                        style: {
                            color: Highcharts.getOptions().colors[1]
                        }
                    },
                    title: {
                        text: 'Average Score Given',
                        style: {
                            color: Highcharts.getOptions().colors[1]
                        }
                    },
                    min: 0,
                    max: 10
                }, { // Secondary yAxis
                    title: {
                        text: 'Number of Ratings Made',
                        style: {
                            color: Highcharts.getOptions().colors[0]
                        }
                    },
                    labels: {
                        format: '{value}',
                        style: {
                            color: Highcharts.getOptions().colors[0]
                        }
                    },
                    opposite: true,
                }],
                tooltip: {
                    shared: true
                },
                legend: {
                    layout: 'vertical',
                    align: 'left',
                    x: 120,
                    verticalAlign: 'top',
                    y: 40,
                    floating: true,
                    backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'
                },
                series: [{
                    name: 'Number of Ratings Made',
                    type: 'column',
                    yAxis: 1,
                    data: [
                            {% for decade in decades_dictionary %}
                                {% if decade.1.0 > 1 %}
                                    {{ decade.1.0 }},
                                {% endif %}
                            {% endfor %}
                    ],
                    tooltip: {
                        valueSuffix: ''
                    }

                }, {
                    name: 'Average Rating Given',
                    type: 'spline',
                    data: [
                            {% for decade in decades_dictionary %}
                                {% if decade.1.0 > 1 %}
                                    {{ decade.1.1 }},
                                {% endif %}
                            {% endfor %}
                    ],
                    tooltip: {
                        valueSuffix: ''
                    }
                }]
            });
        });
    </script>
{% endblock %}